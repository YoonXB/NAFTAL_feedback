<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAFTAL - Test Setup</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test-card { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .test-link { display: inline-block; background: #1e3a8a; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin: 5px; }
        .test-link:hover { background: #3b82f6; }
        .status { padding: 10px; border-radius: 5px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ§ª NAFTAL Feedback System - Test Setup</h1>
    
    <div class="test-card">
        <h2>ğŸ“‹ Survey Flow Test</h2>
        <p>Test the complete user journey:</p>
        <a href="welcome.html" class="test-link">1. Welcome Page</a>
        <a href="client-info.html" class="test-link">2. Client Info</a>
        <a href="index.html" class="test-link">3. Survey Form</a>
        <a href="summary.html" class="test-link">4. Summary</a>
        <a href="thank-you.html" class="test-link">5. Thank You</a>
    </div>
    
    <div class="test-card">
        <h2>ğŸ‘¨â€ğŸ’¼ Admin Interface Test</h2>
        <p>Test the admin dashboard:</p>
        <a href="admin/login.html" class="test-link">Admin Login</a>
        <a href="admin/dashboard.html" class="test-link">Dashboard (Direct)</a>
        <a href="admin/dashboard.php" class="test-link">Old Dashboard</a>
    </div>
    
    <div class="test-card">
        <h2>ğŸ”§ System Status</h2>
        <div id="phpStatus" class="status">Checking PHP...</div>
        <div id="dbStatus" class="status">Checking Database...</div>
        <div id="filesStatus" class="status">Checking Files...</div>
    </div>
    
    <div class="test-card">
        <h2>ğŸ“Š Quick Stats</h2>
        <div id="statsDisplay">Loading...</div>
    </div>
    
    <script>
        // Test PHP availability
        fetch('submit_feedback.php', { method: 'GET' })
            .then(response => {
                document.getElementById('phpStatus').className = 'status success';
                document.getElementById('phpStatus').textContent = 'âœ… PHP is working';
            })
            .catch(error => {
                document.getElementById('phpStatus').className = 'status error';
                document.getElementById('phpStatus').textContent = 'âŒ PHP not available';
            });
        
        // Test database connection
        fetch('admin/get-dashboard-data.php')
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    document.getElementById('dbStatus').className = 'status error';
                    document.getElementById('dbStatus').textContent = 'âŒ Database: ' + data.error;
                } else {
                    document.getElementById('dbStatus').className = 'status success';
                    document.getElementById('dbStatus').textContent = 'âœ… Database connected';
                    
                    // Display stats
                    document.getElementById('statsDisplay').innerHTML = `
                        <p><strong>Total Feedbacks:</strong> ${data.totalFeedbacks || 0}</p>
                        <p><strong>Average Satisfaction:</strong> ${(data.avgSatisfaction || 0).toFixed(1)}/3</p>
                        <p><strong>Recommendation Rate:</strong> ${(data.recommendationRate || 0).toFixed(1)}%</p>
                    `;
                }
            })
            .catch(error => {
                document.getElementById('dbStatus').className = 'status error';
                document.getElementById('dbStatus').textContent = 'âŒ Database connection failed';
                document.getElementById('statsDisplay').textContent = 'Stats unavailable';
            });
        
        // Check if all files exist
        const files = ['welcome.html', 'client-info.html', 'styles.css', 'script.js'];
        let filesOk = 0;
        
        files.forEach(file => {
            fetch(file, { method: 'HEAD' })
                .then(response => {
                    if (response.ok) filesOk++;
                    if (filesOk === files.length) {
                        document.getElementById('filesStatus').className = 'status success';
                        document.getElementById('filesStatus').textContent = 'âœ… All core files present';
                    }
                })
                .catch(() => {
                    document.getElementById('filesStatus').className = 'status error';
                    document.getElementById('filesStatus').textContent = 'âŒ Some files missing';
                });
        });
    </script>
</body>
</html>
