<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAFTAL - VÃ©rification Installation</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f7fa; }
        .check-card { background: white; padding: 25px; border-radius: 10px; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 15px; border-radius: 8px; margin: 10px 0; font-weight: bold; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .test-btn { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .test-btn:hover { background: #0056b3; }
        .file-list { background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; }
        .logo { width: 60px; height: auto; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="check-card">
        <img src="assets/naftal-logo.webp" alt="NAFTAL Logo" class="logo">
        <h1>ğŸ”§ NAFTAL - VÃ©rification Installation WAMP</h1>
        
        <div class="info">
            <strong>ğŸ“ Emplacement attendu:</strong> C:\wamp64\www\naftal-feedback\<br>
            <strong>ğŸŒ URL d'accÃ¨s:</strong> http://localhost/naftal-feedback/setup-check.html
        </div>
        
        <h2>1. Tests SystÃ¨me</h2>
        <div id="systemTests">
            <div id="phpTest" class="status warning">ğŸ”„ Test PHP en cours...</div>
            <div id="mysqlTest" class="status warning">ğŸ”„ Test MySQL en cours...</div>
            <div id="filesTest" class="status warning">ğŸ”„ Test fichiers en cours...</div>
        </div>
        
        <h2>2. Structure des Fichiers Requise</h2>
        <div class="file-list">
naftal-feedback/
â”œâ”€â”€ ğŸ“„ setup-check.html (ce fichier)
â”œâ”€â”€ ğŸ“„ welcome.html
â”œâ”€â”€ ğŸ“„ client-info.html  
â”œâ”€â”€ ğŸ“„ index.html (formulaire enquÃªte)
â”œâ”€â”€ ğŸ“„ summary.html
â”œâ”€â”€ ğŸ“„ thank-you.html
â”œâ”€â”€ ğŸ“„ admin-access.html
â”œâ”€â”€ ğŸ“„ styles.css
â”œâ”€â”€ ğŸ“„ script.js
â”œâ”€â”€ ğŸ“„ submit_feedback.php
â”œâ”€â”€ ğŸ“ assets/
â”‚   â””â”€â”€ ğŸ–¼ï¸ naftal-logo.webp
â”œâ”€â”€ ğŸ“ admin/
â”‚   â”œâ”€â”€ ğŸ“„ login.html
â”‚   â”œâ”€â”€ ğŸ“„ dashboard.html
â”‚   â”œâ”€â”€ ğŸ“„ dashboard.php
â”‚   â”œâ”€â”€ ğŸ“„ login-process.php
â”‚   â”œâ”€â”€ ğŸ“„ get-dashboard-data.php
â”‚   â”œâ”€â”€ ğŸ“„ check-auth.php
â”‚   â”œâ”€â”€ ğŸ“„ logout.php
â”‚   â”œâ”€â”€ ğŸ“„ export_csv.php
â”‚   â””â”€â”€ ğŸ“„ admin-styles.css
â””â”€â”€ ğŸ“ scripts/
    â”œâ”€â”€ ğŸ“„ create_database.sql
    â””â”€â”€ ğŸ“„ sample_data.sql
        </div>
        
        <h2>3. Tests de Navigation</h2>
        <div>
            <button class="test-btn" onclick="testPage('welcome.html')">Test Page Bienvenue</button>
            <button class="test-btn" onclick="testPage('client-info.html')">Test Info Client</button>
            <button class="test-btn" onclick="testPage('index.html')">Test EnquÃªte</button>
            <button class="test-btn" onclick="testPage('admin-access.html')">Test Admin</button>
        </div>
        
        <h2>4. Configuration Base de DonnÃ©es</h2>
        <div id="dbConfig" class="status warning">
            <strong>âš ï¸ Action Requise:</strong> Vous devez crÃ©er la base de donnÃ©es manuellement
        </div>
        
        <div class="info">
            <strong>Instructions Base de DonnÃ©es:</strong><br>
            1. Allez sur <a href="http://localhost/phpmyadmin" target="_blank">phpMyAdmin</a><br>
            2. CrÃ©ez une nouvelle base de donnÃ©es nommÃ©e: <code>naftal_feedback</code><br>
            3. Importez le fichier: <code>scripts/create_database.sql</code><br>
            4. Optionnel: Importez <code>scripts/sample_data.sql</code> pour des donnÃ©es de test
        </div>
        
        <h2>5. DÃ©marrage Rapide</h2>
        <div>
            <a href="welcome.html" class="test-btn">ğŸš€ Commencer l'EnquÃªte</a>
            <a href="admin-access.html" class="test-btn">ğŸ” AccÃ¨s Admin</a>
        </div>
        
        <div id="finalStatus" class="status info">
            <strong>â„¹ï¸ Statut:</strong> VÃ©rification en cours...
        </div>
    </div>
    
    <script>
        let testsCompleted = 0;
        let testsTotal = 3;
        let allTestsPassed = true;
        
        // Test PHP
        fetch('submit_feedback.php', { method: 'GET' })
            .then(response => {
                document.getElementById('phpTest').className = 'status success';
                document.getElementById('phpTest').innerHTML = 'âœ… <strong>PHP:</strong> Fonctionne correctement';
                testsCompleted++;
                checkAllTests();
            })
            .catch(error => {
                document.getElementById('phpTest').className = 'status error';
                document.getElementById('phpTest').innerHTML = 'âŒ <strong>PHP:</strong> Non disponible - VÃ©rifiez que WAMP Apache est dÃ©marrÃ©';
                allTestsPassed = false;
                testsCompleted++;
                checkAllTests();
            });
        
        // Test MySQL via PHP
        fetch('admin/get-dashboard-data.php')
            .then(response => response.json())
            .then(data => {
                if (data.error && data.error.includes('database')) {
                    document.getElementById('mysqlTest').className = 'status warning';
                    document.getElementById('mysqlTest').innerHTML = 'âš ï¸ <strong>MySQL:</strong> ConnectÃ© mais base de donnÃ©es manquante - CrÃ©ez "naftal_feedback"';
                } else if (data.error) {
                    document.getElementById('mysqlTest').className = 'status error';
                    document.getElementById('mysqlTest').innerHTML = 'âŒ <strong>MySQL:</strong> ' + data.error;
                    allTestsPassed = false;
                } else {
                    document.getElementById('mysqlTest').className = 'status success';
                    document.getElementById('mysqlTest').innerHTML = 'âœ… <strong>MySQL:</strong> Base de donnÃ©es connectÃ©e et fonctionnelle';
                    document.getElementById('dbConfig').className = 'status success';
                    document.getElementById('dbConfig').innerHTML = 'âœ… <strong>Base de donnÃ©es:</strong> ConfigurÃ©e et prÃªte';
                }
                testsCompleted++;
                checkAllTests();
            })
            .catch(error => {
                document.getElementById('mysqlTest').className = 'status error';
                document.getElementById('mysqlTest').innerHTML = 'âŒ <strong>MySQL:</strong> Erreur de connexion - VÃ©rifiez que WAMP MySQL est dÃ©marrÃ©';
                allTestsPassed = false;
                testsCompleted++;
                checkAllTests();
            });
        
        // Test Files
        const filesToTest = ['welcome.html', 'styles.css', 'script.js', 'assets/naftal-logo.webp'];
        let filesOk = 0;
        
        filesToTest.forEach(file => {
            fetch(file, { method: 'HEAD' })
                .then(response => {
                    if (response.ok) filesOk++;
                    if (filesOk === filesToTest.length) {
                        document.getElementById('filesTest').className = 'status success';
                        document.getElementById('filesTest').innerHTML = 'âœ… <strong>Fichiers:</strong> Tous les fichiers essentiels sont prÃ©sents';
                    } else if (filesOk === 0) {
                        document.getElementById('filesTest').className = 'status error';
                        document.getElementById('filesTest').innerHTML = 'âŒ <strong>Fichiers:</strong> Fichiers manquants - VÃ©rifiez l\'emplacement';
                        allTestsPassed = false;
                    }
                    testsCompleted++;
                    checkAllTests();
                })
                .catch(() => {
                    document.getElementById('filesTest').className = 'status error';
                    document.getElementById('filesTest').innerHTML = 'âŒ <strong>Fichiers:</strong> Certains fichiers sont manquants';
                    allTestsPassed = false;
                    testsCompleted++;
                    checkAllTests();
                });
        });
        
        function checkAllTests() {
            if (testsCompleted >= testsTotal) {
                const finalStatus = document.getElementById('finalStatus');
                if (allTestsPassed) {
                    finalStatus.className = 'status success';
                    finalStatus.innerHTML = 'ğŸ‰ <strong>Installation RÃ©ussie!</strong> Tous les tests sont passÃ©s. Vous pouvez utiliser le systÃ¨me.';
                } else {
                    finalStatus.className = 'status error';
                    finalStatus.innerHTML = 'âš ï¸ <strong>Installation IncomplÃ¨te:</strong> Certains problÃ¨mes doivent Ãªtre rÃ©solus avant utilisation.';
                }
            }
        }
        
        function testPage(page) {
            window.open(page, '_blank');
        }
        
        // Show current URL info
        document.addEventListener('DOMContentLoaded', () => {
            const currentUrl = window.location.href;
            if (currentUrl.includes('localhost')) {
                console.log('âœ… AccÃ¨s correct via localhost');
            } else {
                const warning = document.createElement('div');
                warning.className = 'status error';
                warning.innerHTML = 'âŒ <strong>Attention:</strong> Vous devez accÃ©der via http://localhost/naftal-feedback/ et non file://';
                document.querySelector('.check-card').insertBefore(warning, document.querySelector('h1').nextSibling);
            }
        });
    </script>
</body>
</html>
